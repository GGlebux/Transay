CREATE TABLE IF NOT EXISTS "person"
(
    "id"            INTEGER PRIMARY KEY generated by default as identity,
    "name"          VARCHAR(255) NOT NULL,
    "gender"        VARCHAR(6)   NOT NULL,
    "date_of_birth" DATE         NOT NULL,
    "is_gravid"     BOOLEAN      NOT NULL DEFAULT false
);


CREATE TABLE IF NOT EXISTS "indicator"
(
    "id"        INTEGER PRIMARY KEY generated by default as identity,
    "eng_name"  VARCHAR(255) NOT NULL,
    "rus_name"  VARCHAR(255) NOT NULL,
    "gender"    VARCHAR(6)   NOT NULL,
    "is_gravid" BOOLEAN      NOT NULL DEFAULT false,
    "min_age"   INTEGER      NOT NULL,
    "max_age"   INTEGER      NOT NULL,
    "min_value" FLOAT(53)    NOT NULL,
    "max_value" FLOAT(53)    NOT NULL,
    "units"     VARCHAR(50)  NOT NULL DEFAULT 'standart'
);


CREATE TABLE IF NOT EXISTS "transcript"
(
    "id"     INTEGER PRIMARY KEY generated by default as identity,
    "name"   VARCHAR(255) NOT NULL,
    "gender" VARCHAR(6)   NOT NULL
);

CREATE TABLE IF NOT EXISTS "referent"
(
    "id"            INTEGER PRIMARY KEY generated by default as identity,
    "current_value" FLOAT(53)                                            NOT NULL,
    "reg_date"      DATE                                                 NOT NULL,
    "status"        VARCHAR(255)                                         NOT NULL,
    "transcript_id" INTEGER REFERENCES transcript (id) ON DELETE CASCADE NOT NULL
);

CREATE TABLE IF NOT EXISTS "reason"
(
    "id"   INTEGER PRIMARY KEY generated by default as identity,
    "name" VARCHAR(255) NOT NULL
);


CREATE TABLE IF NOT EXISTS "fall_reason"
(
    "transcript_id" INTEGER REFERENCES transcript (id) ON DELETE CASCADE,
    "reason_id"     INTEGER REFERENCES reason (id) ON DELETE NO ACTION,
    PRIMARY KEY ("transcript_id", "reason_id")
);

CREATE TABLE IF NOT EXISTS "raise_reason"
(
    "transcript_id" INTEGER REFERENCES transcript (id) ON DELETE CASCADE,
    "reason_id"     INTEGER REFERENCES reason (id) ON DELETE NO ACTION,
    PRIMARY KEY ("transcript_id", "reason_id")
);


CREATE TABLE IF NOT EXISTS "excluded_reason"
(
    "person_id" INTEGER REFERENCES Person (id) NOT NULL,
    "reason_id" INTEGER REFERENCES reason (id) NOT NULL,
    PRIMARY KEY ("person_id", "reason_id")
);


CREATE TABLE IF NOT EXISTS "measure"
(
    "id"           INTEGER PRIMARY KEY generated by default as identity,
    "person_id"    INTEGER REFERENCES Person (id)                     NOT NULL,
    "indicator_id" INTEGER REFERENCES Indicator (id)                  NOT NULL,
    "referent_id"  INTEGER REFERENCES Referent (id) ON DELETE CASCADE NOT NULL
);

CREATE TABLE "unit" (
                         "id" INTEGER GENERATED BY DEFAULT AS IDENTITY,
                         "name" VARCHAR(50) NOT NULL
);

INSERT INTO unit (name)
VALUES ('г/л'),
       ('тера/л'),
       ('фл'),
       ('пг'),
       ('%'),
       ('*10^(9)/л'),
       ('мм/час'),
       ('мкг/л'),
       ('мкмоль/л'),
       ('мкмоль/литр'),
       ('нг/мл'),
       ('мг/л'),
       ('ммоль/л'),
       ('МкЕд/мл'),
       ('ме/л'),
       ('ед/л'),
       ('мМЕ/л'),
       ('нг/дл'),
       ('пмоль/л'),
       ('пг/мл'),
       ('МЕ/мл'),
       ('нмоль/л'),
       ('мкг/сутки'),
       ('мкг/дл'),
       ('мкмоль/сут'),
       ('мкг/сут'),
       ('мкг/литр'),
       ('мм/ч'),
       ('клеток/мкл'),
       ('мкЕд/л');

INSERT INTO reason (name)
VALUES ('дефицит ванадия'),
       ('передозировка рыбьего жира'),
       ('избыточное поступление с воздухом меди'),
       ('панкреатит'),
       ('гипогонадизм'),
       ('болезнь Пламмера'),
       ('гиперфункциональность почек'),
       ('нарушение работы поджелудочной железы'),
       ('гипергидратация'),
       ('киста желтого тела'),
       ('показатель гипоксии'),
       ('повышенное использование витамина в организме'),
       ('сахарный диабет'),
       ('переутомление'),
       ('отсутствие сна'),
       ('избыток белка'),
       ('передозировка гормонов щитовидной железы'),
       ('генетические мутации, нарушающие обмен В12 в организме'),
       ('истинная полицитемия'),
       ('низкий кортизол'),
       ('низкое содержание йода в пище'),
       ('искусственная гипогликемия'),
       ('диффузный токсический зоб'),
       ('передозировка витамина D'),
       ('аллергия'),
       ('применение тиреостатиков'),
       ('нарушение работы надпочечников'),
       ('скрытые кровопотери'),
       ('ослабленный иммунитет'),
       ('избыток метионина'),
       ('стресс'),
       ('высокий инсулин'),
       ('язвы в желудке'),
       ('нарушение работы гипоталамуса'),
       ('гепатиты'),
       ('явные кровопотери'),
       ('доброкачественная нейтропения детского возраста'),
       ('избыточное поступление с водой меди'),
       ('передозировка витамина С'),
       ('повышенная функция паращитовидных желез'),
       ('гипохлоргидрия'),
       ('тиреоидит Хашимото'),
       ('синдром Пендреда'),
       ('менструация'),
       ('изменение регуляции метаболизма йода в организме'),
       ('избыток гормона роста'),
       ('дефицит эстрогена'),
       ('нарушение работы печени'),
       ('себорея'),
       ('дефицит омега-3'),
       ('дефицит белка'),
       ('инъекции В12 в последние 2 месяца'),
       ('повышение фибриногена'),
       ('рвота'),
       ('инфекционный процесс'),
       ('дефицит кальция'),
       ('дефицит витамина А'),
       ('апластическая анемия'),
       ('повышение ферритина'),
       ('пониженная функция паращитовидных желез'),
       ('приём эстрогенов'),
       ('холестаз'),
       ('снижение альбумина'),
       ('ревматоидный артрит'),
       ('дефицит йода'),
       ('простатит'),
       ('поликистоз яичников'),
       ('прием ОК'),
       ('лечение антибиотиками'),
       ('дефицит витамина B6'),
       ('дефицит витамина B9'),
       ('нарушение образования внутреннего фактора Касла'),
       ('прием антигипертензивных средств группы ИАПФ'),
       ('дефицит витамина B2'),
       ('повышение церулоплазмина'),
       ('гемолиз эритроцитов при заборе крови'),
       ('повышение эритроцитов'),
       ('дефицит витамина B1'),
       ('дисбактериоз'),
       ('избыток поступления с пищей фосфора'),
       ('нарушение всасываемости'),
       ('гипохромная анемия'),
       ('курение'),
       ('вирусная инфекция'),
       ('послеродовый тиреоидит'),
       ('прием препаратов с высокими дозами В12'),
       ('высокий уровень окислительного стресса'),
       ('целиакия'),
       ('гормональные нарушения'),
       ('дефицит витамина C'),
       ('приём КОК'),
       ('недостаточность надпочечников'),
       ('беременность'),
       ('дефицит глутатиона'),
       ('недостаток меди в пище'),
       ('алкалоз'),
       ('гиперхромная анемия'),
       ('дефицит витамина D'),
       ('паразитоз'),
       ('первые 6-8 недель терапии препаратами железа'),
       ('диарея'),
       ('недостаточное поступление с пищей'),
       ('пожилой возраст'),
       ('приём глюкокортикоидов'),
       ('талассемия'),
       ('воспалительный процесс'),
       ('избыток пролактина'),
       ('дефицит инозитола'),
       ('прием лекарств для снижения давления'),
       ('почечная недостаточность'),
       ('повышение альдостерона'),
       ('вегетарианство'),
       ('снижение эритроцитов'),
       ('дефицит селена'),
       ('избыток андрогенов'),
       ('гематологические заболевания'),
       ('лимфома'),
       ('опухоли'),
       ('повышенное потоотделение'),
       ('изменение формы эритроцитов'),
       ('низкий уровень ДГЭА-С'),
       ('метаболический синдром'),
       ('нарушение работы почек'),
       ('катаболизм'),
       ('бактериальная инфекция'),
       ('дефицит бетаина'),
       ('инфекция Helicobacter pylori'),
       ('увеличение селезёнки'),
       ('бессолевая диета'),
       ('состояние кетоза'),
       ('прием стероидных гормонов'),
       ('избыток кофе в рационе'),
       ('повышение альбумина'),
       ('физическом перенапряжении'),
       ('дефицит метионина'),
       ('дефицит витамина B12'),
       ('атеросклероз'),
       ('нарушение обмена веществ'),
       ('приём некоторых лекарственных препаратов'),
       ('период активного роста у ребёнка'),
       ('врождённый дефицит лептина'),
       ('мутация гена MTHFR'),
       ('дефицит цинка'),
       ('несбалансированная диета'),
       ('псориаз'),
       ('гемолитическая анемия'),
       ('голодание'),
       ('пониженное выделение кальция с мочой'),
       ('обезвоживание'),
       ('нарушение работы щитовидной железы'),
       ('дефицит железа'),
       ('избыток кальция'),
       ('избыток фитоэстрогенов в рационе'),
       ('избыток алюминия'),
       ('длительный приём препаратов с магнием'),
       ('дробное питание'),
       ('дефицит марганца'),
       ('микросфероцитоз'),
       ('нарушение работы желчного системы'),
       ('мальабсорбция'),
       ('гиперфункциональность кишечника'),
       ('нарушение работы гипофиза'),
       ('злоупотребление БАДами'),
       ('гипертиреоз'),
       ('гиперпротеинемия'),
       ('дефицит холина'),
       ('генетика'),
       ('дефицит фолатов'),
       ('резкая потеря веса'),
       ('прием пищи перед проведением анализа крови'),
       ('повышение С-реактивного белка'),
       ('аутоиммунный тиреоидит'),
       ('избыток железа'),
       ('нарушение работы эндокринной системы'),
       ('инсулинорезистентность'),
       ('недостаток в пище B9'),
       ('гипергликемия'),
       ('лейкоз'),
       ('ацидоз'),
       ('синдром Жильбера'),
       ('избыток углеводов в рационе'),
       ('дефицит хрома'),
       ('снижение гематокрита'),
       ('резистентность к андрогенам'),
       ('высокий кортизол'),
       ('эрозии в желудке'),
       ('малоподвижный образ жизни'),
       ('сердечная недостаточность'),
       ('дефицит фосфора'),
       ('болезни ЖКТ'),
       ('глистная инвазия'),
       ('заболевания крови'),
       ('недостаточность желтого тела'),
       ('гемохроматоз'),
       ('избыток гомоцистеина'),
       ('лептинорезистентность'),
       ('увеличение содержания йода в пище'),
       ('проблемы с усвоением железа в кишечнике'),
       ('дефицит половых гормонов'),
       ('избыточное поступление с воздухом цинка'),
       ('дефицит меди'),
       ('нарушение внутриклеточного обмена'),
       ('гемахроматоз'),
       ('избыток мясной пищи в рационе'),
       ('дефицит магния'),
       ('интоксикация'),
       ('приём мочегонных препаратов'),
       ('ожирение'),
       ('гипопаратиреоз'),
       ('передозировка витаминов фолиевой кислоты'),
       ('нарушение работы тонкого кишечника'),
       ('повышенный холестерин'),
       ('гипотиреоз'),
       ('новообразования'),
       ('токсичные металлы'),
       ('остеопороз'),
       ('пониженная кислотность желудка'),
       ('дефицит жиров в рационе'),
       ('злоупотребление алкоголем'),
       ('нарушения всасывания жиров'),
       ('высокое артериальное давление');

